window.__require=function e(t,o,n){function i(s,a){if(!o[s]){if(!t[s]){var c=s.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!a&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var h=o[s]={exports:{}};t[s][0].call(h.exports,function(e){return i(t[s][1][e]||e)},h,h.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({ChiSelectController:[function(e,t,o){"use strict";cc._RF.push(t,"5bf3e6ZcLRPEYdWhvP//EN+","ChiSelectController");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./G"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.start=function(){var e=this;this.node.on(cc.Node.EventType.MOUSE_UP,function(){e.onMouseDown()}),this.node.on(cc.Node.EventType.TOUCH_END,function(){e.onMouseDown()})},t.prototype.onMouseDown=function(){console.log("playMahjong="+JSON.stringify(this.playMahjong));var e={userId:s.default.userId,roomId:s.default.roomId,chiList:this.mahjongs};s.default.roomManager.ws.send("chi@"+JSON.stringify(e));for(var t=0;t<this.chiSelects.length;t++)this.chiSelects[t].destroy()},r([c],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./G":"G"}],G:[function(e,t,o){"use strict";cc._RF.push(t,"eaaa6Vps+RLgIXeZXTTthCh","G");var n=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.KeChiCMD=o.User=o.Mahjong=void 0;var i=cc._decorator,r=i.ccclass,s=(i.property,function(){function e(){}return e.userId=0,e.roomId=0,e.seatNo=null,e.roomManager=null,e.deleteFromArray=function(e,t){return e.filter(function(e){return e!=t})},e.getMahjongName=function(e){return e.getComponent(cc.Sprite).spriteFrame.name},e.getMahjongIntByNode=function(e){var t=e.getComponent(cc.Sprite).spriteFrame.name;return-1!=t.search("tiao")?parseInt(t.replace("tiao","")):-1!=t.search("tong")?parseInt(t.replace("tong",""))+10:-1!=t.search("wan")?parseInt(t.replace("wan",""))+20:"dong"==t?31:"nan"==t?33:"xi"==t?35:"bei"==t?37:"zhong"==t?41:"fa"==t?43:"bai"==t?45:(console.log("getMahjongIntByNode error name="+t),0)},n([r],e)}());o.default=s;o.Mahjong=function(){};o.User=function(){this.node=null,this.chiPengPosition=null,this.chiPengCardX=0,this.chiPengCardY=0,this.chiPengPrefabList=[]};o.KeChiCMD=function(){},cc._RF.pop()},{}],JoinRoomController:[function(e,t,o){"use strict";cc._RF.push(t,"a65d43NUihAk4Wk5XolEp09","JoinRoomController");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./G"),a=cc._decorator,c=a.ccclass,l=a.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toastLabel=null,t.roomIdInput=null,t.joinRoomBtn=null,t}return i(t,e),t.prototype.start=function(){},t.prototype.joinRoom=function(){var e=this;console.log("\u6635\u79f0\uff1a"+s.default.nickname),null==this.roomIdInput.string||""==this.roomIdInput.string?(this.toastLabel.string="\u8bf7\u8f93\u5165\u623f\u95f4id",this.toastLabel.node.active=!0,setTimeout(function(){e.toastLabel.node.active=!1},1e3)):(s.default.roomId=parseInt(this.roomIdInput.string),cc.director.loadScene("room"))},t.prototype.createRoom=function(){cc.director.loadScene("room")},r([l(cc.Label)],t.prototype,"toastLabel",void 0),r([l(cc.EditBox)],t.prototype,"roomIdInput",void 0),r([l(cc.Button)],t.prototype,"joinRoomBtn",void 0),r([c],t)}(cc.Component);o.default=h,cc._RF.pop()},{"./G":"G"}],LoginController:[function(e,t,o){"use strict";cc._RF.push(t,"32a19cCitVBOYyabH/VVGpq","LoginController");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./G"),a=cc._decorator,c=a.ccclass,l=a.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.toastLabel=null,t.userIdInput=null,t.nameInput=null,t.loginBtn=null,t}return i(t,e),t.prototype.onLoad=function(){cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE)},t.prototype.start=function(){},t.prototype.login=function(){var e=this;null==this.userIdInput.string||""==this.userIdInput.string||null==this.nameInput.string||""==this.nameInput.string?(this.toastLabel.string="\u8bf7\u8f93\u5165\u7528\u6237id\u548c\u6635\u79f0",this.toastLabel.node.active=!0,setTimeout(function(){e.toastLabel.node.active=!1},1e3)):(s.default.userId=parseInt(this.userIdInput.string),s.default.nickname=this.nameInput.string,cc.director.loadScene("joinRoom"))},r([l(cc.Label)],t.prototype,"toastLabel",void 0),r([l(cc.EditBox)],t.prototype,"userIdInput",void 0),r([l(cc.EditBox)],t.prototype,"nameInput",void 0),r([l(cc.Button)],t.prototype,"loginBtn",void 0),r([c],t)}(cc.Component);o.default=h,cc._RF.pop()},{"./G":"G"}],MahjongController:[function(e,t,o){"use strict";cc._RF.push(t,"68117NaX91AM4AT1M+fANdy","MahjongController");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./G"),a=cc._decorator,c=a.ccclass,l=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.start=function(){var e=this;this.node.on(cc.Node.EventType.MOUSE_UP,function(){e.onMouseDown()}),this.node.on(cc.Node.EventType.TOUCH_END,function(){e.onMouseDown()})},t.prototype.onMouseDown=function(){if(s.default.roomManager.isMyTurn){s.default.roomManager.isMyTurn=!1,s.default.roomManager.deleteMyMahjonsByNode(this.node),s.default.roomManager.sortMyMahjongs();var e={userId:s.default.userId,roomId:s.default.roomId,mahjong:{name:this.node.getComponent(cc.Sprite).spriteFrame.name}};s.default.roomManager.ws.send("playCard@"+JSON.stringify(e)),this.node.destroy()}},r([c],t)}(cc.Component));o.default=l,cc._RF.pop()},{"./G":"G"}],RoomManager:[function(e,t,o){"use strict";cc._RF.push(t,"f8f57ZB0tFBP4OMnVnghOrp","RoomManager");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./ChiSelectController"),a=e("./G"),c=e("./Sounds"),l=cc._decorator,h=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.roomIdLabel=null,t.bgmAudioSource=null,t.paiAudioSource=null,t.sounds=null,t.ws=null,t.readyBtn=null,t.huResult=null,t.mjAtlas=null,t.mjPrefab=null,t.playPrefab=null,t.chiSelectPrefab=null,t.topThreePrefab=null,t.leftThreePrefab=null,t.rightThreePrefab=null,t.wealthGod=null,t.myMahjongs=[],t.playCardList=[],t.isMyTurn=!1,t.bottomPosition=null,t.playCardPosition=null,t.chiSelectPosition=null,t.chiPengPosition=null,t.leftChiPengPosition=null,t.rightChiPengPosition=null,t.topChiPengPosition=null,t.xDistance=36,t.yDistance=48,t.xDistancePlay=18,t.yDistancePlay=25,t.playCardX=0,t.playCardY=0,t.xDistanceChiPeng=57,t.yDistanceChiPeng=20,t.pengBtn=null,t.chiBtn=null,t.huBtn=null,t.guoBtn=null,t.chiMahjongName=null,t.huMahjongName=null,t.keChiCMDLocal=null,t.bottom=null,t.right=null,t.top=null,t.left=null,t.allUser=[],t}return i(t,e),t.prototype.start=function(){var e=this;a.default.roomManager=this,this.sounds=this.node.getComponent(c.default),this.ws=new WebSocket("ws://1.116.140.57:8080"),this.ws.onopen=function(){console.log("Send Text WS was opened.");var t={userId:a.default.userId,name:a.default.nickname,v:1};e.ws.send("login@"+JSON.stringify(t))},this.ws.onmessage=function(t){console.log("response text msg: "+t.data),e.receiveMsg(t.data)},this.ws.onerror=function(){console.log("Send Text fired an error")},this.ws.onclose=function(){console.log("WebSocket instance closed.")}},t.prototype.myLog=function(e){console.log(e)},t.prototype.deleteMyMahjonsByNode=function(e){this.myMahjongs=this.myMahjongs.filter(function(t){return t!=e})},t.prototype.playMahjongSound=function(e){var t;-1!=e.search("tiao")?t=e.replace("tiao",""):-1!=e.search("tong")?(t=e.replace("tong",""),t=(parseInt(t)+20).toString()):-1!=e.search("wan")?(t=e.replace("wan",""),t=(parseInt(t)+10).toString()):t=e,this.paiAudioSource.clip=this.sounds["mj"+t],this.paiAudioSource.play()},t.prototype.receiveMsg=function(e){var t=e.split("@");if(!(t.length<2)){var o=t[1];"shuffle"==t[0]?this.ReceiveShuffleCMD(o):"loginResult"==t[0]?this.ReceiveLoginResult(o):"createRoomSuccess"==t[0]?this.ReceiveCreateRoomSuccess(o):"joinRoomResult"==t[0]?this.ReceiveJoinRoomResult(o):"recover"==t[0]?this.receiveRecoverCMD(o):"leaveRoomSuccess"==t[0]?this.ReceiveLeaveRoomSuccess(o):"turn"==t[0]?this.ReceiveTurnCMD(o):"playCard"==t[0]?this.ReceivePlayCardCMD(o):"kePeng"==t[0]?this.ReceiveKePengCMD(o):"pengSuccess"==t[0]?this.ReceivePengSuccessCMD(o):"keChi"==t[0]?this.ReceiveKeChiCMD(o):"chiSuccess"==t[0]?this.ReceiveChiSuccessCMD(o):"keHu"==t[0]?this.ReceiveKeHuCMD(o):"huSuccess"==t[0]&&this.ReceiveHuSuccessCMD(o)}},t.prototype.ReceiveLoginResult=function(e){switch(JSON.parse(e).type){case"versionTooLow":this.myLog("\u7248\u672c\u592a\u4f4e,\u8bf7\u5347\u7ea7\u65b0\u7248\u672c");break;case"userNotExist":this.myLog("\u7528\u6237\u4e0d\u5b58\u5728,\u8bf7\u66f4\u6362\u7528\u6237id");break;case"userAlreadyLogin":this.myLog("\u7528\u6237\u5df2\u767b\u5f55,\u8bf7\u66f4\u6362\u7528\u6237id");break;case"loginSuccess":if(console.log("*room"+a.default.roomId+"*"),0==a.default.roomId)this.ws.send("createRoom@"+a.default.userId);else{var t={userId:a.default.userId,roomId:a.default.roomId};this.ws.send("joinRoom@"+JSON.stringify(t))}}},t.prototype.ReceiveCreateRoomSuccess=function(e){this.roomIdLabel.string="\u623f\u95f4id: "+e},t.prototype.ReceiveJoinRoomResult=function(e){var t=JSON.parse(e);switch(t.type){case"alreadyInRoom":this.myLog("\u5df2\u7ecf\u5728\u623f\u95f4 "+t.roomId);break;case"roomNotExist":this.myLog(t.roomId+" \u623f\u95f4\u4e0d\u5b58\u5728");break;case"joinRoomSuccess":this.generateAllUsers(t.users,t.roomId)}},t.prototype.receiveRecoverCMD=function(e){this.bgmAudioSource.play();var t=JSON.parse(e);a.default.roomId=t.roomId;for(var o=0;o<t.mahjongs.length;o++){var n=cc.instantiate(this.mjPrefab);n.setParent(this.node.getParent()),n.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(t.mahjongs[o].name),n.x=this.bottomPosition.x+o*this.xDistance,n.y=this.bottomPosition.y,this.myMahjongs.push(n)}for(this.sortMyMahjongs(),this.wealthGod.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(t.wealthGod.name),this.wealthGod.active=!0,this.generateAllUsers(t.users,t.roomId),o=0;o<this.allUser.length;o++)null!=this.allUser[o]&&(this.allUser[o].userId==t.bankerUserId?this.allUser[o].node.getChildByName("nickname").getComponent(cc.Label).enableUnderline=!0:this.allUser[o].node.getChildByName("nickname").getComponent(cc.Label).enableUnderline=!1);for(o=0;o<t.playedMahjongs.length;o++)this.add2PlayCardList(t.playedMahjongs[o].name);for(o=0;o<t.users.length;o++)for(var i=t.users[o],r=0;r<i.eatBumpList.length;r++){var s=i.eatBumpList[r];0==s.type?this.createChiPengPrefab(s.mahjongs[0].name,s.mahjongs[1].name,s.mahjongs[2].name,"l",i.userId,null):1==s.type?this.createChiPengPrefab(s.mahjongs[0].name,s.mahjongs[1].name,s.mahjongs[2].name,null,i.userId,s.fromUserId):2==s.type?this.createChiPengPrefab(s.mahjongs[0].name,s.mahjongs[1].name,s.mahjongs[2].name,null,i.userId,s.fromUserId):3==s.type&&this.createChiPengPrefab(s.mahjongs[0].name,s.mahjongs[1].name,s.mahjongs[2].name,null,i.userId,s.fromUserId)}},t.prototype.generateAllUsers=function(e,t){for(var o=0;o<e.length;o++)this.allUser[e[o].seatNo]={nickname:e[o].nickname,userId:e[o].userId,score:e[o].score,seatNo:e[o].seatNo,node:null,chiPengPosition:null,chiPengCardX:0,chiPengCardY:0,chiPengPrefabList:[]},e[o].userId==a.default.userId&&(a.default.seatNo=e[o].seatNo);this.updateAllUser(),this.roomIdLabel.string="\u623f\u95f4id: "+t},t.prototype.updateAllUser=function(){for(var e=(a.default.seatNo+2)%4,t=(a.default.seatNo+3)%4,o=(a.default.seatNo+1)%4,n=0;n<this.allUser.length;n++)null!=this.allUser[n]&&(n==e?(this.allUser[n].node=this.top,this.allUser[n].chiPengPosition=this.topChiPengPosition):n==t?(this.allUser[n].node=this.left,this.allUser[n].chiPengPosition=this.leftChiPengPosition):n==o?(this.allUser[n].node=this.right,this.allUser[n].chiPengPosition=this.rightChiPengPosition):(this.allUser[n].node=this.bottom,this.allUser[n].chiPengPosition=this.chiPengPosition));this.updateAllUserInfo()},t.prototype.updateAllUserInfo=function(){for(var e=0;e<this.allUser.length;e++)if(null!=this.allUser[e]){var t=this.allUser[e].node;t.getChildByName("nickname").getComponent(cc.Label).string=this.allUser[e].nickname,t.getChildByName("score").getComponent(cc.Label).string=""+this.allUser[e].score}},t.prototype.ReceiveLeaveRoomSuccess=function(e){this.bgmAudioSource.stop(),JSON.parse(e).userId==a.default.userId&&(a.default.roomId=0)},t.prototype.ReceiveShuffleCMD=function(e){this.bgmAudioSource.play();for(var t=JSON.parse(e),o=0;o<t.mahjongs.length;o++){var n=cc.instantiate(this.mjPrefab);n.setParent(this.node.getParent()),n.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(t.mahjongs[o].name),n.x=this.bottomPosition.x+o*this.xDistance,n.y=this.bottomPosition.y,this.myMahjongs.push(n)}for(this.wealthGod.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(t.wealthGod.name),this.wealthGod.active=!0,o=0;o<this.allUser.length;o++)null!=this.allUser[o]&&(this.allUser[o].userId==t.bankerUserId?this.allUser[o].node.getChildByName("nickname").getComponent(cc.Label).enableUnderline=!0:this.allUser[o].node.getChildByName("nickname").getComponent(cc.Label).enableUnderline=!1);this.myLog("\u53d1\u724c\u7ed3\u675f"),this.sortMyMahjongs()},t.prototype.sortMyMahjongs=function(){this.myMahjongs.sort(function(e,t){var o=a.default.getMahjongIntByNode(e),n=a.default.getMahjongIntByNode(t);return o<n?-1:o>n?1:0});for(var e=0;e<this.myMahjongs.length;e++)this.myMahjongs[e].x=this.bottomPosition.x+e*this.xDistance,this.myMahjongs[e].y=this.bottomPosition.y},t.prototype.ReceiveTurnCMD=function(e){for(var t=JSON.parse(e),o=0;o<this.allUser.length;o++)null!=this.allUser[o]&&(this.allUser[o].userId==t.userId?this.allUser[o].node.getChildByName("turnRed").active=!0:this.allUser[o].node.getChildByName("turnRed").active=!1);if(t.userId==a.default.userId){var n=cc.instantiate(this.mjPrefab);n.setParent(this.node.getParent()),n.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(t.mahjong.name),n.x=this.bottomPosition.x+504,n.y=this.bottomPosition.y,this.myMahjongs.push(n),this.isMyTurn=!0}},t.prototype.ReceivePlayCardCMD=function(e){var t=JSON.parse(e);this.add2PlayCardList(t.mahjong.name),this.playMahjongSound(t.mahjong.name)},t.prototype.add2PlayCardList=function(e){var t=cc.instantiate(this.playPrefab);t.setParent(this.node.getParent()),t.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(e),t.x=this.playCardPosition.x+this.playCardX*this.xDistancePlay,t.y=this.playCardPosition.y-this.playCardY*this.yDistancePlay,this.playCardList.push(t),19==this.playCardX?(this.playCardX=0,this.playCardY++):this.playCardX++},t.prototype.ReceiveKePengCMD=function(e){JSON.parse(e),this.pengBtn.active=!0,this.guoBtn.active=!0},t.prototype.ReceivePengSuccessCMD=function(e){var t=JSON.parse(e);if(this.playMahjongSound("peng"),this.createChiPengPrefab(t.mahjong.name,t.mahjong.name,t.mahjong.name,null,t.userId,t.fromUserId),t.userId==a.default.userId){for(var o=this.myMahjongs,n=[],i=0,r=0;r<o.length&&(a.default.getMahjongName(o[r])==t.mahjong.name&&(n.push(o[r]),i++),2!=i);r++);this.deleteMyMahjonsByNode(n[0]),this.deleteMyMahjonsByNode(n[1]),n[0].destroy(),n[1].destroy(),this.sortMyMahjongs(),this.isMyTurn=!0}},t.prototype.ReceiveKeChiCMD=function(e){var t=JSON.parse(e);this.keChiCMDLocal=t,this.chiBtn.active=!0,this.guoBtn.active=!0},t.prototype.ReceiveChiSuccessCMD=function(e){var t=JSON.parse(e);if(this.playMahjongSound("chi"),this.createChiPengPrefab(t.chiList[0].name,t.chiList[1].name,t.chiList[2].name,"l",t.userId,null),t.userId==a.default.userId){for(var o=[],n=0;n<t.chiList.length;n++)if(t.chiList[n].name!=t.playMahjong.name)for(var i=0;i<this.myMahjongs.length;i++)if(a.default.getMahjongName(this.myMahjongs[i])==t.chiList[n].name){o.push(this.myMahjongs[i]);break}this.deleteMyMahjonsByNode(o[0]),this.deleteMyMahjonsByNode(o[1]),o[0].destroy(),o[1].destroy(),this.sortMyMahjongs(),this.isMyTurn=!0}},t.prototype.createChiPengPrefab=function(e,t,o,n,i,r){for(var s=null,c=0;c<this.allUser.length;c++)null!=this.allUser[c]&&this.allUser[c].userId==i&&(s=this.allUser[c]);if(null!=r){var l=0,h=0;for(c=0;c<this.allUser.length;c++)null!=this.allUser[c]&&(this.allUser[c].userId==i&&(l=c),this.allUser[c].userId==r&&(h=c));var u=Math.abs(l-h);n=2==u?"t":1==u&&l>h?"l":"r"}var p=null;(p="l"==n?cc.instantiate(this.leftThreePrefab):"r"==n?cc.instantiate(this.rightThreePrefab):cc.instantiate(this.topThreePrefab)).setParent(this.node.getParent());var d=p.getChildByName("first"),g=p.getChildByName("second"),f=p.getChildByName("third");return d.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(e),g.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(t),f.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(o),(a.default.seatNo+1)%4==s.seatNo?(p.angle=90,p.x=s.chiPengPosition.x+s.chiPengCardX*this.yDistanceChiPeng,p.y=s.chiPengPosition.y+s.chiPengCardY*this.xDistanceChiPeng,s.chiPengCardY++,s.chiPengCardY>=3&&(s.chiPengCardY=0,s.chiPengCardX++)):(a.default.seatNo+2)%4==s.seatNo?(p.angle=180,p.x=s.chiPengPosition.x-s.chiPengCardX*this.xDistanceChiPeng,p.y=s.chiPengPosition.y+s.chiPengCardY*this.yDistanceChiPeng,s.chiPengCardX++,s.chiPengCardX>=3&&(s.chiPengCardX=0,s.chiPengCardY++)):(a.default.seatNo+3)%4==s.seatNo?(p.angle=270,p.x=s.chiPengPosition.x-s.chiPengCardX*this.yDistanceChiPeng,p.y=s.chiPengPosition.y-s.chiPengCardY*this.xDistanceChiPeng,s.chiPengCardY++,s.chiPengCardY>=3&&(s.chiPengCardY=0,s.chiPengCardX++)):(p.angle=0,p.x=s.chiPengPosition.x+s.chiPengCardX*this.xDistanceChiPeng,p.y=s.chiPengPosition.y-s.chiPengCardY*this.yDistanceChiPeng,s.chiPengCardX++,s.chiPengCardX>=3&&(s.chiPengCardX=0,s.chiPengCardY++)),s.chiPengPrefabList.push(p),p},t.prototype.ReceiveKeHuCMD=function(e){JSON.parse(e),this.huBtn.active=!0,this.guoBtn.active=!0},t.prototype.ReceiveHuSuccessCMD=function(e){var t=JSON.parse(e);this.playMahjongSound("hu");for(var o=0;o<t.users.length;o++){var n=t.users[o];n.userId==t.userId&&(this.huResult.getChildByName("desc").getComponent(cc.Label).string=n.nickname+" "+t.huName),this.allUser[n.seatNo].score=n.score}this.updateAllUserInfo(),this.huResult.active=!0,this.readyBtn.active=!0},t.prototype.ready=function(){this.readyBtn.active=!1,this.huResult.active=!1,this.wealthGod.active=!1;for(var e=0;e<this.myMahjongs.length;e++)this.myMahjongs[e].destroy();for(e=0;e<this.playCardList.length;e++)this.playCardList[e].destroy();for(e=0;e<this.allUser.length;e++)if(null!=this.allUser[e]){for(var t=0;t<this.allUser[e].chiPengPrefabList.length;t++)this.allUser[e].chiPengPrefabList[t].destroy();this.allUser[e].chiPengPrefabList=[],this.allUser[e].chiPengCardX=0,this.allUser[e].chiPengCardY=0}this.myMahjongs=[],this.playCardList=[],this.isMyTurn=!1,this.keChiCMDLocal=null,this.chiMahjongName=null,this.huMahjongName=null,this.playCardX=0,this.playCardY=0;var o={userId:a.default.userId,roomId:a.default.roomId};this.ws.send("ready@"+JSON.stringify(o))},t.prototype.chi=function(){var e=this.keChiCMDLocal,t=null,o=null,n=null;e.fist.length>0&&(t=this.CreateChiSelect(e.fist,e.playMahjong,this.chiSelectPosition.x,this.chiSelectPosition.y)),e.second.length>0&&(o=this.CreateChiSelect(e.second,e.playMahjong,this.chiSelectPosition.x+this.xDistanceChiPeng,this.chiSelectPosition.y)),e.third.length>0&&(n=this.CreateChiSelect(e.third,e.playMahjong,this.chiSelectPosition.x+this.xDistanceChiPeng,this.chiSelectPosition.y));var i=[];null!=t&&i.push(t),null!=o&&i.push(o),null!=n&&i.push(n),null!=t&&(t.getComponent(s.default).chiSelects=i),null!=o&&(o.getComponent(s.default).chiSelects=i),null!=n&&(n.getComponent(s.default).chiSelects=i),this.myLog("chi over 555"),this.chiBtn.active=!1,this.guoBtn.active=!1},t.prototype.CreateChiSelect=function(e,t,o,n){var i=cc.instantiate(this.chiSelectPrefab);i.setParent(this.node.getParent());var r=i.getChildByName("first"),a=i.getChildByName("second"),c=i.getChildByName("third");return r.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(e[0].name),a.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(e[1].name),c.getComponent(cc.Sprite).spriteFrame=this.mjAtlas.getSpriteFrame(e[2].name),i.getComponent(s.default).mahjongs=e,i.getComponent(s.default).playMahjong=t,i.x=o,i.y=n,i},t.prototype.peng=function(){this.pengBtn.active=!1,this.guoBtn.active=!1;var e={userId:a.default.userId,roomId:a.default.roomId};this.ws.send("peng@"+JSON.stringify(e))},t.prototype.gang=function(){},t.prototype.hu=function(){this.huBtn.active=!1,this.guoBtn.active=!1;var e={userId:a.default.userId,roomId:a.default.roomId};this.ws.send("hu@"+JSON.stringify(e))},t.prototype.guo=function(){this.chiBtn.active=!1,this.pengBtn.active=!1,this.huBtn.active=!1,this.guoBtn.active=!1,this.keChiCMDLocal=null;var e={userId:a.default.userId,roomId:a.default.roomId};this.ws.send("guo@"+JSON.stringify(e))},r([u(cc.Label)],t.prototype,"roomIdLabel",void 0),r([u(cc.AudioSource)],t.prototype,"bgmAudioSource",void 0),r([u(cc.AudioSource)],t.prototype,"paiAudioSource",void 0),r([u(cc.Node)],t.prototype,"readyBtn",void 0),r([u(cc.Node)],t.prototype,"huResult",void 0),r([u(cc.SpriteAtlas)],t.prototype,"mjAtlas",void 0),r([u(cc.Prefab)],t.prototype,"mjPrefab",void 0),r([u(cc.Prefab)],t.prototype,"playPrefab",void 0),r([u(cc.Prefab)],t.prototype,"chiSelectPrefab",void 0),r([u(cc.Prefab)],t.prototype,"topThreePrefab",void 0),r([u(cc.Prefab)],t.prototype,"leftThreePrefab",void 0),r([u(cc.Prefab)],t.prototype,"rightThreePrefab",void 0),r([u(cc.Node)],t.prototype,"wealthGod",void 0),r([u(cc.Node)],t.prototype,"bottomPosition",void 0),r([u(cc.Node)],t.prototype,"playCardPosition",void 0),r([u(cc.Node)],t.prototype,"chiSelectPosition",void 0),r([u(cc.Node)],t.prototype,"chiPengPosition",void 0),r([u(cc.Node)],t.prototype,"leftChiPengPosition",void 0),r([u(cc.Node)],t.prototype,"rightChiPengPosition",void 0),r([u(cc.Node)],t.prototype,"topChiPengPosition",void 0),r([u(cc.Node)],t.prototype,"pengBtn",void 0),r([u(cc.Node)],t.prototype,"chiBtn",void 0),r([u(cc.Node)],t.prototype,"huBtn",void 0),r([u(cc.Node)],t.prototype,"guoBtn",void 0),r([u(cc.Node)],t.prototype,"bottom",void 0),r([u(cc.Node)],t.prototype,"right",void 0),r([u(cc.Node)],t.prototype,"top",void 0),r([u(cc.Node)],t.prototype,"left",void 0),r([h],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./ChiSelectController":"ChiSelectController","./G":"G","./Sounds":"Sounds"}],Sounds:[function(e,t,o){"use strict";cc._RF.push(t,"88fe6piSyBL8I/NyC7IlI3u","Sounds");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,c=s.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mj1=null,t.mj2=null,t.mj3=null,t.mj4=null,t.mj5=null,t.mj6=null,t.mj7=null,t.mj8=null,t.mj9=null,t.mj11=null,t.mj12=null,t.mj13=null,t.mj14=null,t.mj15=null,t.mj16=null,t.mj17=null,t.mj18=null,t.mj19=null,t.mj21=null,t.mj22=null,t.mj23=null,t.mj24=null,t.mj25=null,t.mj26=null,t.mj27=null,t.mj28=null,t.mj29=null,t.mjdong=null,t.mjnan=null,t.mjxi=null,t.mjbei=null,t.mjzhong=null,t.mjfa=null,t.mjbai=null,t.mjchi=null,t.mjpeng=null,t.mjgang=null,t.mjhu=null,t}return i(t,e),r([c(cc.AudioClip)],t.prototype,"mj1",void 0),r([c(cc.AudioClip)],t.prototype,"mj2",void 0),r([c(cc.AudioClip)],t.prototype,"mj3",void 0),r([c(cc.AudioClip)],t.prototype,"mj4",void 0),r([c(cc.AudioClip)],t.prototype,"mj5",void 0),r([c(cc.AudioClip)],t.prototype,"mj6",void 0),r([c(cc.AudioClip)],t.prototype,"mj7",void 0),r([c(cc.AudioClip)],t.prototype,"mj8",void 0),r([c(cc.AudioClip)],t.prototype,"mj9",void 0),r([c(cc.AudioClip)],t.prototype,"mj11",void 0),r([c(cc.AudioClip)],t.prototype,"mj12",void 0),r([c(cc.AudioClip)],t.prototype,"mj13",void 0),r([c(cc.AudioClip)],t.prototype,"mj14",void 0),r([c(cc.AudioClip)],t.prototype,"mj15",void 0),r([c(cc.AudioClip)],t.prototype,"mj16",void 0),r([c(cc.AudioClip)],t.prototype,"mj17",void 0),r([c(cc.AudioClip)],t.prototype,"mj18",void 0),r([c(cc.AudioClip)],t.prototype,"mj19",void 0),r([c(cc.AudioClip)],t.prototype,"mj21",void 0),r([c(cc.AudioClip)],t.prototype,"mj22",void 0),r([c(cc.AudioClip)],t.prototype,"mj23",void 0),r([c(cc.AudioClip)],t.prototype,"mj24",void 0),r([c(cc.AudioClip)],t.prototype,"mj25",void 0),r([c(cc.AudioClip)],t.prototype,"mj26",void 0),r([c(cc.AudioClip)],t.prototype,"mj27",void 0),r([c(cc.AudioClip)],t.prototype,"mj28",void 0),r([c(cc.AudioClip)],t.prototype,"mj29",void 0),r([c(cc.AudioClip)],t.prototype,"mjdong",void 0),r([c(cc.AudioClip)],t.prototype,"mjnan",void 0),r([c(cc.AudioClip)],t.prototype,"mjxi",void 0),r([c(cc.AudioClip)],t.prototype,"mjbei",void 0),r([c(cc.AudioClip)],t.prototype,"mjzhong",void 0),r([c(cc.AudioClip)],t.prototype,"mjfa",void 0),r([c(cc.AudioClip)],t.prototype,"mjbai",void 0),r([c(cc.AudioClip)],t.prototype,"mjchi",void 0),r([c(cc.AudioClip)],t.prototype,"mjpeng",void 0),r([c(cc.AudioClip)],t.prototype,"mjgang",void 0),r([c(cc.AudioClip)],t.prototype,"mjhu",void 0),r([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{}]},{},["ChiSelectController","G","JoinRoomController","LoginController","MahjongController","RoomManager","Sounds"]);